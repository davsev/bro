<?php

/**
 * The ajax-specific functionality of the plugin.
 *
 * @link       https://cobweb-security.com
 * @since      3.3.3
 *
 * @package    Cwis
 * @subpackage Cwis/includes
 * @author     Cobweb Security <cwis@cobweb-security.com>
 */
class Cwis_Ajax extends Cwis_Foundation
{

    /**
     * Creates the AJAX callback function.
     *
     * @since    2.0.3.1
     */
    public function cwis_scanner_ajax_callback()
    {

        // Scanner ID for authentication in AJAX interface.
        define('CWIS_AJAX_ID', get_option('CWIS_AJAX_ID'));

        // Password to scan report (and file editing in PRO version).
        define('CWIS_AJAX_PASS', get_option('CWIS_AJAX_PASS'));

        // Scanner core signature
        define('CWIS_SIGNATURE', 'ezscan7objrldgpfvmqkdthyuwi3x3x9');

        // Absolute path to the root directory
        define('CWIS_ROOT_PATH', dirname(dirname(__FILE__)));

        // Absolute path to the working directory
        define('CWIS_WORK_PATH', CWIS_ROOT_PATH . DIRECTORY_SEPARATOR . 'cwis-scan');

        // Get upload path
        $upload_dir = wp_upload_dir();
        $upload_path = $upload_dir['basedir'] . '/cwis';

        // Absolute path to the temporary files directory
        define('CWIS_TEMP_PATH', $upload_path);

        // Path to the starting point for the scan
        define('CWIS_SCAN_PATH', substr(ABSPATH, 0, -1));

        // Include scanner "bootstrap" file
        require_once(CWIS_WORK_PATH . DIRECTORY_SEPARATOR . 'cwis-bootstrap.php');

        wp_die(); // exit with a proper response
    }

}
